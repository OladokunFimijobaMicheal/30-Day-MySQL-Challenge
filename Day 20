# Rank every film within its category and gave each one a unique sequence number, ignoring ties.
SELECT c.name AS Category,
       f.title AS 'Film Title',
       f.rental_duration AS 'Rental Duration',
       ROW_NUMBER() OVER (PARTITION BY c.name ORDER BY f.rental_duration DESC) AS 'Row Number'
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id;
